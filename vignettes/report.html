<!DOCTYPE html>
<!-- saved from url=(0089)file:///C:/Users/Eddie/AppData/Local/Temp/RtmpmcbOB9/preview-869c1b113511.dir/report.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<meta name="generator" content="pandoc">

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sixian Zhang, Zaoyi Chi, Hao Wang, Zhaolu Yang">

<meta name="date" content="2019-03-08">

<title>Report for Coding project 2: linear models for regression and binary classification</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css">

<script type="text/javascript" src="./report_files/MathJax.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.2') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>




<h1 class="title toc-ignore">Report for Coding project 2: linear models for regression and binary classification</h1>
<h4 class="author"><em>Sixian Zhang, Zaoyi Chi, Hao Wang, Zhaolu Yang</em></h4>
<h4 class="date"><em>2019-03-08</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>For this project we created an R package with R code that implements a version of the linear models for both regression and binary classification.</p>
<p>Here are some significant formulas that have been used in this function:</p>
<p><strong>Loss Function: </strong></p>
<p><strong>1.Square Loss (Regression): </strong><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 12.801em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1010.66em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="texatom" id="MathJax-Span-8" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-9"><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-17" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.598em;"><span class="mi" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic; padding-left: 0.241em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.18em, 4.408em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -4.461em; left: 0.301em;"><span class="mn" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.688em; left: 0.301em;"><span class="mn" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mi>w</mi><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow><mi>n</mi></msub><mo>−</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-1">L(w) = ||Xw + {\beta}_n-y||^2_2</script></span></p>
<p><strong>2.Logistic Loss (Binary classification): </strong><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33" style="width: 21.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1017.68em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-40" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1001.01em, 4.408em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.48em, 4.17em, -999.997em); top: -4.461em; left: 1.074em;"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.25em, 4.17em, -999.997em); top: -3.688em; left: 1.074em;"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic; padding-left: 0.182em;">l</span><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic; padding-left: 0.241em;">e</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">−</span><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="munderover" id="MathJax-Span-63"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.84em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.045em; left: 0.182em;"><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.717em;"><span class="mi" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-74" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.598em;"><span class="mi" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></munderover><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">[</mo><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><msup><mi>w</mi><mi>t</mi></msup><mi>x</mi><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">L(w) = \sum^{n}_{i=1}log[1+exp(-\hat{y_i}(w^tx + {\beta}_n)]</script></span></p>
<p><strong>Cost Function: </strong> <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 12.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1010.3em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="msubsup" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">L</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic; padding-left: 0.241em;">λ</span><span class="texatom" id="MathJax-Span-96"><span class="mrow" id="MathJax-Span-97"><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-99"><span class="mrow" id="MathJax-Span-100"><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.18em, 4.408em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -4.461em; left: 0.301em;"><span class="mn" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.688em; left: 0.301em;"><span class="mn" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>+</mo><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3">C_\lambda(w) = L(w)+\lambda||w||^2_2</script></span></p>
</div>
<div id="main-function" class="section level2">
<h2>Main Function</h2>
<p>The purpose of this section is to give users a general information of this package. We will briefly go over the main functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Source Code:
<span class="kw">library</span>(LinearModel)

<span class="kw">data</span>(spam, <span class="dt">package =</span> <span class="st">"ElemStatLearn"</span>)
<span class="kw">data</span>(SAheart, <span class="dt">package =</span> <span class="st">"ElemStatLearn"</span>)
<span class="kw">data</span>(zip.train, <span class="dt">package =</span> <span class="st">"ElemStatLearn"</span>)
zip.train &lt;-<span class="st"> </span>zip.train[zip.train[,<span class="dv">1</span>] <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),]
<span class="kw">data</span>(prostate, <span class="dt">package =</span> <span class="st">"ElemStatLearn"</span>)
<span class="kw">data</span>(ozone, <span class="dt">package =</span> <span class="st">"ElemStatLearn"</span>)

data.list &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">spam =</span> <span class="kw">list</span>(
    <span class="dt">features =</span> <span class="kw">as.matrix</span>(spam[, <span class="dv">1</span><span class="op">:</span><span class="dv">57</span>]),
    <span class="dt">labels =</span> <span class="kw">ifelse</span>(spam<span class="op">$</span>spam <span class="op">==</span><span class="st"> "spam"</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">is.01 =</span> <span class="ot">TRUE</span>
  ),

  <span class="dt">SAheart =</span> <span class="kw">list</span>(
    <span class="dt">features =</span> <span class="kw">as.matrix</span>(SAheart[, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">6</span><span class="op">:</span><span class="dv">9</span>)]),
    <span class="dt">labels =</span> SAheart<span class="op">$</span>chd,
    <span class="dt">is.01 =</span> <span class="ot">TRUE</span>
  ),

  <span class="dt">zip.train =</span> <span class="kw">list</span>(
    <span class="dt">features =</span> <span class="kw">as.matrix</span>(zip.train[, <span class="op">-</span><span class="dv">1</span>]),
    <span class="dt">labels =</span> zip.train[, <span class="dv">1</span>],
    <span class="dt">is.01 =</span> <span class="ot">TRUE</span>
  ),

  <span class="dt">prostate =</span> <span class="kw">list</span>(<span class="dt">features =</span> <span class="kw">as.matrix</span>(prostate[, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]),
                  <span class="dt">labels =</span> prostate<span class="op">$</span>lpsa,
                  <span class="dt">is.01 =</span> <span class="ot">FALSE</span>),

  <span class="dt">ozone =</span> <span class="kw">list</span>(<span class="dt">features =</span> <span class="kw">as.matrix</span>(ozone[,<span class="op">-</span><span class="dv">1</span>]),
               <span class="dt">labels =</span> ozone[, <span class="dv">1</span>],
               <span class="dt">is.01 =</span> <span class="ot">FALSE</span>)
)

n.folds &lt;-<span class="st"> </span>4L</code></pre></div>
</div>
<div id="experimentsapplication" class="section level2">
<h2>Experiments/application</h2>
<p>We are going to run our code on the following data sets.</p>
</div>
<div id="data-set-1-spam" class="section level2">
<h2>Data set 1: spam</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Spam</span>
data.name  =<span class="st"> </span><span class="dv">1</span>
data.set &lt;-<span class="st"> </span>data.list[[data.name]]
test.loss.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)

<span class="co">#Check data type here:</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)

fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">length</span>(data.set<span class="op">$</span>labels)))

penalty.vec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="op">-</span><span class="fl">0.1</span>)

<span class="cf">for</span> (i.fold <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n.folds)) {
  train.index &lt;-<span class="st"> </span>fold.vec <span class="op">!=</span><span class="st"> </span>i.fold
  test.index &lt;-<span class="st"> </span><span class="op">!</span>train.index

  x.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>features[train.index, ]
  y.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[train.index]
  x.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>feature[test.index, ]
  y.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[test.index]

  <span class="cf">if</span> (data.set<span class="op">$</span>is.<span class="dv">01</span>) {
    <span class="co"># binary data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 100L, <span class="fl">0.5</span>)
    L2.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-
<span class="st">      </span><span class="kw">ifelse</span>(earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    L2.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(L2.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">mean</span>(y.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span> , <span class="dv">1</span>, <span class="dv">0</span>)
    <span class="co"># baseline.predict &lt;- mean(y.test)</span>

  } <span class="cf">else</span>{
    <span class="co"># regression data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMSquareLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 50L)
    L2.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-<span class="st"> </span>earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    L2.predict &lt;-<span class="st"> </span>L2.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">mean</span>(y.test)
  }

  <span class="co"># L2 loss</span>
  earlystopping.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((earlystopping.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  L2.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((L2.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  baseline.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((baseline.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

  test.loss.mat[i.fold,] =<span class="st"> </span><span class="kw">c</span>(earlystopping.loss, L2.loss, baseline.loss)
}</code></pre></div>
<div id="matrix-of-loss-values" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show result</span>
<span class="kw">colnames</span>(test.loss.mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Early Stopping"</span>, <span class="st">"L2"</span>, <span class="st">"Baseline"</span>)

test.loss.mat
<span class="co">#&gt;      Early Stopping        L2  Baseline</span>
<span class="co">#&gt; [1,]     0.10425717 0.1476977 0.4144222</span>
<span class="co">#&gt; [2,]     0.09043478 0.1095652 0.3991304</span>
<span class="co">#&gt; [3,]     0.10695652 0.1043478 0.3878261</span>
<span class="co">#&gt; [4,]     0.10086957 0.1104348 0.3747826</span>

<span class="co"># plot result</span>
<span class="kw">barplot</span>(
  test.loss.mat,
  <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">"Binary Classification: "</span>, <span class="st">"spam"</span>),
  <span class="dt">xlab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(test.loss.mat)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAA2FBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrKwArKysrK1UrK4ArVYArVaorgKorgNRNTU1VAABVACtVKwBVKytVVVVVgIBVgKpVgNRVqqpVqtRVqv+AKwCAKyuAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1KqA1NSA1P+WlpaqVQCqVSuqVYCqgCuqgFWqqlWq1ICq1Kqq1NSq1P+q/6qq/9Sq///Dw8PUgCvUgFXUqlXUqoDU1KrU1NTU1P/U///m5ub/qlX/1ID/1Kr//6r//9T///8gPgbwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATe0lEQVR4nO3dC3fjxAGGYSVsmrDl5hpoC8RtKbQE0ytbtgJaXAVb//8fVZrRjMZ2ZDv7WdaM9L7nkPVmbWXieaKLrYisJBLKhh4ApR2ASApAJAUgkgIQSQGIpABEUgAiKQCRFIBICkAkBSCSAhBJAYikAERSACIpAJEUgEgKQCQFIJICEEkBiKQARFIjA5Rntqv3XpXlZpHdrJ6/jM0PL6slvPOqPHUJ9l6bb+6y7L1DD9j85fWbjineRgooy67fdLLWHzVLmD0PUFE/5oMDD/j5ozceU8SNFlA9/29SNcOu+2dNd55dPRy8w7JGPbpGB8hO0uNddttMfzWxX32TZS/M7P5Yr17eeTD3vPrio+yqvl9VUXNplpC9+LJaXVSOblYNoPZR5fcvm+1jcNPca2m2nF814uqt4FufbX1Fc4fr75o7/PhxdYffruxA/PgSXD+NFNCPd9UayAFqdoseSruZsTftp2/+ah/g1w7VY+ytze/e/yncOIWPMndpb+4DWvqVYPvYLUDNg4ObZvEAGrp2E1bv1jpAL17VH42oX6zqtdPM3PPmVfnf6i/Vqmc9tyui8FadWULwqPpfV+UP2fZNv6Z7aMV9sPp5XuEKv+Ky3S+rPmFHZgfixgegwfOArj4rW0D3zTat7j9/q7Yut2Xz6fo+t+EWzM61y09o86jqX1986+/obu4Bsuuz/L1vt75iAGgZrPd2xpdaYwW0s2Zo1iybP9h/u233ec1Gb+l/8J8C1D7K7mGbfZftm1uAwvVI8BVbQO4O5iHh+BJsdIDsHozbfmwDqif9xR//Mw8B1duw6h+dmqc3Yf5RP9tj/Ks/hTefAHTbLsA/tgXkvohZ8QEophwgMy17gOzqZb0FqJ7t4Ag82ImuDrDMEsJHVW4+f9ns/fqbB9ZA4WNZAyWQXwMtngJUuN2NWfCyTXXjZbDrun8YHz7KtPm9f0XH3OzYByre+XLrK3buAwEonoJ9oK01g18D3axqGrcBoOqT4auO+y8kBo8yh1f1xsuwcjefOgp732z57ve+4lNHYcE+GkdhA9cC8pO1sw+0uxNtPhm+ROzfyng/2Adyj/qmfc3mm6e+zmbrdaDtr1h0vQ4EoHjygN55Ve4DMsdEL77M2y1HXZFtbz2aN1PrY/D2KKx5VNm+0dre3AdkX4n+pNz6ipv69eZvw1eiP7FDBlDatS8C0fMDULUbM8Y3OS/V1AFVm443fuOeSgBVgK4+GHoQKTd1QCQGIJICEEkBiKQA1F17+uoyu/7nx+bErzI4SbV+8e/Hl/WpR9/fNafMTi8AdRacvroMTjttT1I1LwHUvXT3m2AA6io4Z7UGdP2qvn0bnhZbA5rVn80+a94YnWAA6io4Z7UGdF+2p943J6lWgG5WzcftMxknFIC6Cs5ZdXLs+6X+JFX7Bqj9CCDaLTh9tQFUv+0anKQKoBJAB/OnrwZroOAkVQCVADqWPX012AcKTlIFUAmg7oJzVsOjsOAkVQCVADpQcPqqex3InhXPTnQQgLprT1+ttl3fVQdf5lXp9iRVAJUAOq1xXpnlLAHolADUGYBOCUCdAeiUANQZgEgKQCQFIJICEEkBiKQARFIAIikAkRSASApAJAUgkgIQSQGIpABEUgAiKQCRFIBICkAxlR1p6PE9UYxjmm7Zrw4W42TFOKbpBiCSmgigxzv+3xL9NHJA/pqA070iYM+NHFBZ2N//Zg3UV2MHVK2D6v+dFYD6avSAynJ59QCg3poAoDLPZgDqqykAqtY/bwGopyYBqL5GF4D6aRqAqLemAyjndaA+mg6g3aXE/H5xQk0WUF+Lm1rHAEV4sgeAYuoYoK8PlQIgd5Hkzj0gAEmNHVDuroVcdF0UGUBSIwe0WXg2ef2emLg42mvkgNZz/wJi0bERA5DUyAGxBuq7kQOq9oGaVRD7QP00dkD+nMSO9Q+AxEYP6NKLm1oAApAUgAAkpQEa5I0OAMWUBujfhwLQFAIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCCpPgH19E4ZgGKqT0D/OxSAxhGAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJTQNQkWVXD+dbHLWNHtAyy2aP767K9fz+HIujncYOaHmzKpdm7ZNXt+TF0W4jB2TWO49v14CK69fy4miv0QOaVR83P5WsgXpq5IDK3K13LCV1cbTb2AGVuT38KrKOfWgAaY0e0KUXN7UABCCp6QDKOQrro+kA2l2K7yyLm2yTBdTX4qYWgAAkNXpAm4XdUHXsAQFIbOyA8qx5/bDIeCGxj0YOaLPwbHgro5dGDig4iYM3U3tp5IBYA/XdyAFV+0DNKoh9oH4aO6BqI2aPwjrWPwASGz2gSy9uagEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkBSAASQEIQFIAApAUgAAkNXpAeZZl9+bG9eszLI52Gjug/OqhXM9vSwD11MgBbRYz8/FmBaB+Gjmg9dxsvsrlzQpAvTRyQHYNVLW8BVAvjRyQ33Ct5xmA+mjsgKqjMLsR2ywA1EejB3TpxU0tAAFIajqA2InupekA2l2K7yyLm2yTBdTX4qYWgAAkNXpAm4XdUHXsAQFIbOyA8qx5KbpwN6TF0W4jB+Tfyqgo3azkxdFeIwfk3kytKjiM76ORA2IN1HcjB+TfCmMfqKfGDqh+G97Usf4BkNjoAV16cVMLQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkAAUgKQACSAhCApAAEICkApQIoO9xgwwLQeRfXW4dnCkDPGPIZv/3zL663AAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgqR4BKVfPA9BIAEkIhJkaOaD1vH0Or1/LixuyI4AOTtTXAAqH/Jw7bxYdbt5scQMGoEEAVYJuz7m4Y/V3MV4ADQOoLLL7cy7uSEeeEmXJABoG0LMXJ61EYgV0OAAJ7QM6/IwcWVqkgHqbKQABCEAnlZ96GN8nIOXFGgBFtQbqnrY+AfU2UwA6vZQ3YQAC0JGlAWhkgDaLg29kAAhAB8uzmb1RuBtHFwcgAPk2C88mv1mdtjgAAci3nvv3MYoYDuMBlBgg1kAA2h/yc+6cu7dS2QcCkBvys+7tTinrWP88H9CRADQyQM9fXJIzFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxUpMMCUCozFemwAJTKTEU6LAClMlORDgtAqcxU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"><!-- --></p>
<p>Comment on difference in accuracy: In this data set, both Early Stopping and L2 gain a good accuracy better than the baseline predictor.</p>
</div>
<div id="trainvalidation-loss-plot" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run CV for whole dataset</span>
<span class="cf">if</span>(data.set<span class="op">$</span>is.<span class="dv">01</span>){
  <span class="co"># Binary</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMLogisticLossL2CV</span>(data.set<span class="op">$</span>features, data.set<span class="op">$</span>labels, <span class="ot">NULL</span>, penalty.vec)
}<span class="cf">else</span>{
  <span class="co"># Regression</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(data.set<span class="op">$</span>features,data.set<span class="op">$</span>labels,<span class="ot">NULL</span>, penalty.vec)
}

dot.x &lt;-<span class="st"> </span>model.list<span class="op">$</span>selected.penalty
dot.y &lt;-<span class="st"> </span>model.list<span class="op">$</span>mean.validation.loss.vec[penalty.vec <span class="op">==</span><span class="st"> </span>model.list<span class="op">$</span>selected.penalty]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec),
  <span class="dt">x =</span> <span class="kw">as.matrix</span>(penalty.vec),
  <span class="dt">xlab =</span> <span class="st">"penalty"</span>,
  <span class="dt">ylab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">type =</span> <span class="st">"l"</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
    <span class="dt">x =</span> <span class="dv">0</span>,
    <span class="dt">y =</span> <span class="kw">max</span>(<span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec)),
    <span class="kw">c</span>(<span class="st">"Validation loss"</span>, <span class="st">"Train loss"</span>),
    <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
    <span class="dt">xjust =</span> <span class="dv">0</span>,
    <span class="dt">yjust =</span> <span class="dv">1</span>
)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAb1BMVEUAAAAAACsAAFUAKysAK4AAVaorAAArACsrAFUrKysrK4ArgNRVAABVACtVgIBVqqpVqv+AKwCAVQCAgFWAqoCA1KqA1P+qVQCq1ICq///UgCvU1P/U/6rU/9TU////AAD/qlX/1ID//6r//9T///834HDhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dAZvjqJGGmVxPb5LpvUwnuXbiu5t1d+v//8ZYsmWLqgIKFUjg/t5nd2wjhLD0NhQSkt0AgAG3dwVA30AgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARMQCJiAQMBEYYEceBD2EqhscWAvIBAwAYGACQgETEAgYAICARMQCJiAQMAEBAImIBAwAYGACQgETEAgYAICARO7C7T3bAQlZb/9A7G/QGXLrUQftZSpW3cIpKKPWspAoAboo5YyEKgB+qilTN0ADgKp6KOWMhCoAfqopUjlISQEUtFHLUVc3cpDIBV91FLE1a09BFLRRy1FIFAL9FFLEVc3ioZAKvqopQgEaoE+aikCgVqgj1qKuLpngiCQij5qKeEgkMzn65/+fX3z/Zb48fLz/N/1w+nb2z376edwX0IILrjTsUC3fyqWXzRjZnGryz25n97riKfCUqCoIxDIWn7RjJnFrS734+XS8hyefi3SIBABAgU5TH3Yx8uP8b1zY0N068KOzn37xyjQZcH7s3NP/zctOZ0Tfow5//birm3XtMo1fco6ps+v1lruzRQDVax/YwLlzCt9f56EmDQ5N0bH85tZoNGtkzsnLBbMnvyc2q6Pl3Pq8dJGjQvm9KnQ84f5tc633xCNQJZvV0mg8QiOf8PL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"><!-- --></p>
<p>What are the optimal regularization parameters? Answer: 0.2</p>
</div>
</div>
<div id="data-set-2-saheart" class="section level2">
<h2>Data set 2: SAheart</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#SAheart</span>
data.name  =<span class="st"> </span><span class="dv">2</span>
data.set &lt;-<span class="st"> </span>data.list[[data.name]]
test.loss.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)

<span class="co">#Check data type here:</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)

fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">length</span>(data.set<span class="op">$</span>labels)))

penalty.vec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="op">-</span><span class="fl">0.1</span>)

<span class="cf">for</span> (i.fold <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n.folds)) {
  train.index &lt;-<span class="st"> </span>fold.vec <span class="op">!=</span><span class="st"> </span>i.fold
  test.index &lt;-<span class="st"> </span><span class="op">!</span>train.index

  x.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>features[train.index, ]
  y.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[train.index]
  x.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>feature[test.index, ]
  y.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[test.index]

  <span class="cf">if</span> (data.set<span class="op">$</span>is.<span class="dv">01</span>) {
    <span class="co"># binary data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 100L, <span class="fl">0.5</span>)
    L2.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-
<span class="st">      </span><span class="kw">ifelse</span>(earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    L2.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(L2.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">mean</span>(y.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span> , <span class="dv">1</span>, <span class="dv">0</span>)
    <span class="co"># baseline.predict &lt;- mean(y.test)</span>

  } <span class="cf">else</span>{
    <span class="co"># regression data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMSquareLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 50L)
    L2.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-<span class="st"> </span>earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    L2.predict &lt;-<span class="st"> </span>L2.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">mean</span>(y.test)
  }

  <span class="co"># L2 loss</span>
  earlystopping.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((earlystopping.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  L2.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((L2.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  baseline.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((baseline.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

  test.loss.mat[i.fold,] =<span class="st"> </span><span class="kw">c</span>(earlystopping.loss, L2.loss, baseline.loss)
}</code></pre></div>
<div id="matrix-of-loss-values-1" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show result</span>
<span class="kw">colnames</span>(test.loss.mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Early Stopping"</span>, <span class="st">"L2"</span>, <span class="st">"Baseline"</span>)

test.loss.mat
<span class="co">#&gt;      Early Stopping        L2  Baseline</span>
<span class="co">#&gt; [1,]      0.3620690 0.3534483 0.4137931</span>
<span class="co">#&gt; [2,]      0.2931034 0.3017241 0.3534483</span>
<span class="co">#&gt; [3,]      0.3130435 0.3217391 0.2608696</span>
<span class="co">#&gt; [4,]      0.3130435 0.2956522 0.3565217</span>

<span class="co"># plot result</span>
<span class="kw">barplot</span>(
  test.loss.mat,
  <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">"Binary Classification: "</span>, <span class="st">"SAheart"</span>),
  <span class="dt">xlab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(test.loss.mat)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAA21BMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrKwArKysrK1UrK4ArVYArVaorgKorgNRNTU1VAABVACtVKwBVKytVVStVVVVVgIBVgKpVgNRVqqpVqtRVqv+AKwCAKyuAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1KqA1NSA1P+WlpaqVQCqVSuqVYCqgCuqgFWqqlWq1ICq1NSq1P+q/6qq/9Sq///Dw8PUgCvUgFXUqlXUqoDU1IDU1KrU1NTU1P/U///m5ub/qlX/1ID/1Kr//6r//9T////SB9CnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAT6ElEQVR4nO3djXrjxAFGYSVsmkD5M4b+AI0LFFqCobRsu1WhFFdZW/d/RZVmNCPJtmQ7X2TPSOc8D4s3iZWR540k24o2yYmEkksPgOIOQCQFIJICEEkBiKQARFIAIikAkRSASApAJAUgkgIQSQGIpABEUgAiKQCRFIBICkAkBSCSAhBJAYikAERSACKpkQFKE9vVuy/zfLNIblanL2Pz41vFEt5+mR+7BPtVm2/vkuTdvjtsvnv11DGF20gBJcn1Uydr/VG1hNlpgLLyPu/33OH1R08eU8CNFlA5/0+pmGHX/UnTnSZXD71fsCxRj67RAbKT9HiX3FbTX0zs198myQszuz+Vm5e3H8xXXn35UXJVfl1RVnKplpC8+KrYXBSOblYVoPpe+b/fqvaPjZvmq5Zmz/l1Ja7cC77xh9Z3NF9w/c/qC376TfEFH6/sQPz4Itw+jRTQT3fFFsgBqg6LHnK7m7E37Ydv/mrv4LcOxX3src0f3/uluXNq3st8SX1zF9DSbwTr+7YAVXdu3DSLB9Clq3dh5WGtA/TiZfmnEfWrVbl1mpmvvHmZ/7f4S7HpWc/thqh5q8wsoXGv8rOr/MekfdNv6R5qce+vXs8LXM3vuKyPy4oP2JHZgbjxAejieUBXf8hrQPfVPq3s5++LvcttXn24/Jrb5h7MzrXLT2h1r+KzL37wX+hu7gCy27P03R9a37EBaNnY7m2NL7bGCmhry1BtWTaf28/d1se8Zqe39D/4+wDV97JH2ObYpX2zBai5HWl8xxqQ+wJzl+b4Imx0gOwRjNt/tAGVk/7iTz/Pm4DKfVjxSadm/y7M3+u1fY5/9efmzT2AbusF+PvWgNw3MRs+AIWUA2SmZQeQ3bysW4DK2W48A28cRBdPsMwSmvcq3HzxVnX062/2bIGa92ULFEF+C7TYByhzhxuzxss2xY23Goeuu0/jm/cybT7zr+iYmx3HQNnbX7W+Y+cxEIDCqXEM1Noy+C3Qzaqk0dgClR9svuq4+0Ji417m6VW58zKs3M19z8LeM3u++53vuO9ZWOMYjWdhF64G5Cdr6xho+yDafLD5ErF/K+O9xjGQu9e39Ws23+77PpvW60Dt75h1vQ4EoHDygN5+me8CMs+JXnyV1nuOsixp7z2qN1PL5+D1s7DqXnn9Rmt9cxeQfSX6k7z1HTfl680/NF+J/sQOGUBxV78IRKcHoOIwZoxvcp6rqQMqdh1PfuOecgAVgK7ev/QgYm7qgEgMQFttvq/P+MnNEXbjte1jl/HddA6qANTOvXBzVT0xWybuOdrxgMy5q1MJQO38C0nWgDnGvq0+cyygcZ672hGA2i3NmUTlmw9mu5MlV7+tOLROjS1fFLx6z7zmt32W7PVHtb8JBKB21dbDvXW6TG7+U91MG5sms2EqML3ad5bsZwCacAWCq49/cH8rTxSqz70oz4G1b4AWzF5aZHvOkmUXNuWqg+gXX5ndU1afsFOdemrOPatOQHPnjmydJQugaWfeI7W7J3uqa7U7a58WUr8Vv3uWLIAm3ubnL+6MCA9l67SLrD5nZN9ZsgCabv68Q/cLE/7csq0t0H3rDmsAkal8a+yTlfnFRHOqquu2Bahx/um+s2QBNOHShhn3u1r2RPvmiV/m1aLX8/b5ro3fFDr6TY/4A1A7v9Xxv/KXV0+vmoCq14HsKYg7B9EZrwNNOHtCa/kLg/43fOw58K3fnnj9eXkxIHMJod2zZM25qy97vseYAhBJAYikAERSACIpAJEUgEgKQCQFIJICEEkBiKQARFIAIikAkRSASApAJAUgkgIQSQGIpABEUgAiKQCRFIBCKjnQpce3pxDHNN2SD3oLcbJCHNN0mwigxzv+aYBhGjmg6hd6G9egpOdt5IDyzF77hC3QUI0dULENKi+1BKChGj2gPF9ePQBosCYAKE+TGYCGagqAiu3PGwAaqEkAKq+bA6BhmgYgGqzpAEp5HWiIpgNoeykhv90XUZMFNNTiphaAQlzFiBo9IHdR284joBBXMaLGDih1/0B21vUvZYe4ihE1ckCbhWeTmn9CS1sc7TRyQOu5fwEx69iJhbiKETVyQGyBhm7kgIpjoGoTxDHQMI0dkD8nsWP7AyCx0QM69+KmFoBCXMWIAlCIqxhRAApxFSMKQCGuYkQBKMRVjCgAhbiKEQWgEFcxogAU4ipGFIBCXMWIAlCIqxhRAApxFSMKQCGuYkQBKMRVjCgAhbiKEQWgEFcxogAU4ipGFIBCXMWIAlCIqxhRAApxFSMKQCGuYkQBKMRVjCgAhbiKEQWgEFcxogAU4ipGFIBCXMWIAlCIqxhRANpZXHz/BN8lA9AuoOgekUsGIABJAQhAUgACkBSAACQ1IKChns0AKKSGBPS/vgA0jgAUC6BAX546BEgYNYCetSiH9UHyTV8AOmNRDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlOBDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlOBDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlOBDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlOBDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlOBDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlOBDgtAscxUoMMCUCwzFeiwABTLTAU6LADFMlMHhjXcpT0ANA1A/+oLQEoAApAUgAAkBSAASQEIQFIAApAUgAAk9byADrzgolyzFECTANQ/U8JDAiAAAShWQFmSXD0cuzgAndLoAS2TZPb4zipfz++PXByATmnsgJY3q3xptj5pceuoxQHolEYOyGx3Ht8sAWXXr45bHIBOafSAZsWfm19ytkAA8ss95YtTt92xlI5ZHIBOaeyA8tQ+/cqSjmNoAAFIC0AAkhoJoAMBqLHcp90tHfezsN6J+gZAzeU++Z6tpXS+hQmgkx7HqQLqXhyATnr4ALTzAQCd8vCNHdBmYXdUHUdAAAJQb2lSvX6YJeN+IVECNNh5btED2iw8m5G/lSEBGmxY0QNqnMQx8jdTAXR0F94CSa/YASgyQMUxULUJerZjoDBnKtBhxQ+o2InZLUPH9gdAABIDEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAFwTUH4AAdADQYMM6aca1AAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAJICEICkAAQgKQABSApAAOorTZLk3ty4fnXc4qKcqUCHFT+g9OohX89vcwABqHPGe9osZubPmxWAANQ14z2t52b3lS9vVgACUMeM92S3QEXLWwABqGPG+3Js1vMEQADaP+O9pfY5WLEtAhCA9s+4FoAAJAUgAB0VB9EA6pjxpy3Ft/OZGGcq0GGNGFD34qKcqUCHBaBYZirQYY0A0GZhd1QdR0AAAlBvaVK9FJ25GwcXF+VMBTqs6AH5tzIKSjer4xYX5UwFOqzoAbk3U4synsYDaP+M98QWCECHZ7wv91YYx0AA6pzx3tZz+yysY/sDIACJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhA3a3nie/61XGLi3KmAh1W9IDyzaLDTffiopypQIcVP6BC0O2Ji4typgId1ggA5Vlyf9riopypQIc1BkAnLy7KmQp0WACKZaYCHRaAYpmpQIc1JkApT+MBtH/Gn7YU385nYpypQIc1YkDdi4typgIdFoBimalAhzUCQJtF7xsZAAJQb2kyszcyd+Pg4qKcqUCHFT2gzcKzSW9Wxy0uypkKdFjRA1rP/fsYGU/jAbR/xntiCwSgwzPeV+reSuUYCEBdM96bO6WsY/sDIACJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIABJAQhAUgACkBSAACQFIAD1tVkkputXxy4uypkKdFjxA0qTmb2RuRsHFxflTAU6rOgBbRaeTXqzOm5xUc5UoMOKHtB6fu9uZh07MQABqDu2QAA6PON9pUm1CeIYCEBdM97bem6fhXVsfwAEIDEAAUgKQAA6qpRnYQDaP+NPW4qv+zPn7sgBM6zDw+od8pPvSZQDiMSe+c1UmlrP/GYqTa1nfiuDptYzv5lKU4stEEk985upNLWe+c1Umlq8DkRSACIpAJEUgEgKQCQFIJICEEkBiKQARFIAIikAkRSASApAJAUgkgIQSQGIpABEUmcEtEz2n87YOFe/+rv7zbOs/Ymttu83eEs3cvPrcRc4qdc+glcPfV9TPCpnfWDOCajjRNit9c3MidfL4mE6u5ADuRXYLIrBpcnthQaQ9go694MWHqClmZjN4jZYQI935bi6LlAy+ADW876N30QAlRvjYkXXH36RXP9jfm/QpF6O7fHO7O4yu7t4fPPLu/aN8qFazz+dJ3aTVWzbv+jfuj/nChRbymG/WfcALJHqETSPkrmRJu5RaT8w6bC728sAKsGkZidVfKxY3/L3FDcL+6OT+X2DeaTKPdp6fls+UPfmL/6GfZzKvUnx37JYQnbg8OAZV6D826W2QOYHzT2CZmtYPhr2L7MaUPXAuI8P1QUOoouV/PDB7gjM1rha5cc3q9kvf6bM5JQftb/MWPy02wchvVn5G/Zxmpkl2b3K8oyALvGrcUv/LMQ/gu5XhO1+rfibB2QfGP/xocZ0sWOgLKk2IuaP4geq+cuuxdOc6iDayvBEjKTqhn2c7ALsIzTwXqW5AtkFjqGrAbhvXT2C1oZddSPmvvXAuI8PNabLACr2y9d/v2sAKgAs2z/RS/PDVK16cctuoEpA7kbzcUrPDOgyv5pbDaDcebpH0L6kcG+OFMt2ALmPDzWmiwAyKh6bgNYf/uXDh/pzuRdSb4F6AZ15C5Re5le7qwEUPy3+EbQfv3rwq753CzRgFwFkpjtr7sI2i1/7F1lu3dfsOQZaumOgpTsGsguonlmfCVA63A/0MQMo/ucfQVPzxcMtQIM/q7/YFmg9T2Y1oMbPdGZeqs7MZ2fNZ2GFDvssrLrRfJzO+ixsyCc1RwzAPgjVI2i2MFn1bKvcFG0B8h8fakwXeBZmXsYt/rRrWwHyz8GqtzLMGi+brwPd/f7O7Mr9jdbjVC79+m/DPrOuVmCW+vU4c423MtwjaB4e95Hyyes2IPfxoQrlzdTHdw5c8MPv8HueUXDZq/MXCqD00F6hH5D5YP9r/DRIYQB6vDt4xaEDW6Bs0Oeq1FkYgCjaAERSACIpAJEUgEgKQCQFIJICEEkBiKQARFIAIikAkRSASApAJAUgkgIQSQGIpABEUgAiKQCRFIBICkAkBSCSAhBJAeioTr3IRWjXBx0uAB0VgLoC0FEBqKspA3q8Ky+FO3u827oerrsGsb9Srr9grP0Cd2Vdf4Xd3F+3sb7vffsCK6O97MO0AZlLFZVXHCz/c9fDra9B7K7bVF3H0V/qyl5Z119h111WbXmzqu9737rE08WuSTV40wY083/U18NtX4O4uhZIAcFfbM9dhah5NaLUXNpp1rivBzT4hXYv27QB3dd/tK6H274Gcd64DKOhZjG4/1efd5f4dPc924V2LxuAHCB/PdydaxDnDUD2wp/2QMf9v6zYd5VXMGzc92wX2r1sAGptgZof7doCma9yl610/8/Kf/Kjdd+zXWj3sgGo+sM/8d69BnHePgbKqw9s/f935XViG/et/7GBkW57bAByf7jr4e65BnH7WZi7sq6/wq5pWf4DBM37bhY3q2InN/yFdi8bgPwf7nq4u9cg3nodyF1ZN2te6zdzryX5+5aXK/70DBfavWxTBkTPEIBICkAkBSCSAhBJAYikAERSACIpAJEUgEgKQCQFIJICEEkBiKQARFIAIikAkRSASApAJAUgkgIQSQGIpABEUgAiqf8DknQ22Ripz78AAAAASUVORK5CYII="><!-- --></p>
<p>Comment on difference in accuracy: In this data set, the accuracy of Early Stopping and L2 is only a little bit better than the baseline predictor, which may due to the limited training data.</p>
</div>
<div id="trainvalidation-loss-plot-1" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run CV for whole dataset</span>
<span class="cf">if</span>(data.set<span class="op">$</span>is.<span class="dv">01</span>){
  <span class="co"># Binary</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMLogisticLossL2CV</span>(data.set<span class="op">$</span>features, data.set<span class="op">$</span>labels, <span class="ot">NULL</span>, penalty.vec)
}<span class="cf">else</span>{
  <span class="co"># Regression</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(data.set<span class="op">$</span>features,data.set<span class="op">$</span>labels,<span class="ot">NULL</span>, penalty.vec)
}

dot.x &lt;-<span class="st"> </span>model.list<span class="op">$</span>selected.penalty
dot.y &lt;-<span class="st"> </span>model.list<span class="op">$</span>mean.validation.loss.vec[penalty.vec <span class="op">==</span><span class="st"> </span>model.list<span class="op">$</span>selected.penalty]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec),
  <span class="dt">x =</span> <span class="kw">as.matrix</span>(penalty.vec),
  <span class="dt">xlab =</span> <span class="st">"penalty"</span>,
  <span class="dt">ylab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">type =</span> <span class="st">"l"</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
    <span class="dt">x =</span> <span class="dv">0</span>,
    <span class="dt">y =</span> <span class="kw">max</span>(<span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec)),
    <span class="kw">c</span>(<span class="st">"Validation loss"</span>, <span class="st">"Train loss"</span>),
    <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
    <span class="dt">xjust =</span> <span class="dv">0</span>,
    <span class="dt">yjust =</span> <span class="dv">1</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>What are the optimal regularization parameters? Answer: 0.3</p>
</div>
</div>
<div id="data-set-3-zip.train" class="section level2">
<h2>Data set 3: zip.train</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#zip.train</span>
data.name  =<span class="st"> </span><span class="dv">3</span>
data.set &lt;-<span class="st"> </span>data.list[[data.name]]
test.loss.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)

<span class="co">#Check data type here:</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)

fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">length</span>(data.set<span class="op">$</span>labels)))

penalty.vec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="op">-</span><span class="fl">0.1</span>)

<span class="cf">for</span> (i.fold <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n.folds)) {
  train.index &lt;-<span class="st"> </span>fold.vec <span class="op">!=</span><span class="st"> </span>i.fold
  test.index &lt;-<span class="st"> </span><span class="op">!</span>train.index

  x.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>features[train.index, ]
  y.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[train.index]
  x.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>feature[test.index, ]
  y.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[test.index]

  <span class="cf">if</span> (data.set<span class="op">$</span>is.<span class="dv">01</span>) {
    <span class="co"># binary data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 100L, <span class="fl">0.5</span>)
    L2.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-
<span class="st">      </span><span class="kw">ifelse</span>(earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    L2.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(L2.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">mean</span>(y.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span> , <span class="dv">1</span>, <span class="dv">0</span>)
    <span class="co"># baseline.predict &lt;- mean(y.test)</span>

  } <span class="cf">else</span>{
    <span class="co"># regression data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMSquareLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 50L)
    L2.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-<span class="st"> </span>earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    L2.predict &lt;-<span class="st"> </span>L2.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">mean</span>(y.test)
  }

  <span class="co"># L2 loss</span>
  earlystopping.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((earlystopping.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  L2.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((L2.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  baseline.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((baseline.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

  test.loss.mat[i.fold,] =<span class="st"> </span><span class="kw">c</span>(earlystopping.loss, L2.loss, baseline.loss)
}</code></pre></div>
<div id="matrix-of-loss-values-2" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show result</span>
<span class="kw">colnames</span>(test.loss.mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Early Stopping"</span>, <span class="st">"L2"</span>, <span class="st">"Baseline"</span>)

test.loss.mat
<span class="co">#&gt;      Early Stopping L2  Baseline</span>
<span class="co">#&gt; [1,]    0.000000000  0 0.4709091</span>
<span class="co">#&gt; [2,]    0.000000000  0 0.4309091</span>
<span class="co">#&gt; [3,]    0.001818182  0 0.4818182</span>
<span class="co">#&gt; [4,]    0.001821494  0 0.4080146</span>

<span class="co"># plot result</span>
<span class="kw">barplot</span>(
  test.loss.mat,
  <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">"Binary Classification: "</span>, <span class="st">"zip.train"</span>),
  <span class="dt">xlab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(test.loss.mat)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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gNp2eXYDoGzlBCT831j3zvJjn1BXMwDlKieg/+3riIDM+PMegDI1CUDtZlEBKE/TAETZmg6gms+BcjQdQOOp6Fvz1E4YUK7JTS0AAUiqeEBmB2z/kTAASZUOqPbHwuJBMXFyNK5wQJtFZFPbY2Li5GirwgGt5/EDxGbHSgxAUoUDYgTKXeGAzDZQNwSxDZSn0gHFcxJ3jD8AEise0LEnN7UABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCCpaQBqqurs5nCTo77iAS2ranb7wapdz68PMTkaVTqg5cWqXbrRpza35MnRuMIBuXHn9n0LqDl/I0+Otioe0Mx83fzYMgJlqnBAbR3GHU9JnRyNKx1QW/vdr6basQ0NIK3iAR17clMLQACSmg6gmr2wHE0H0HgqsYNMbrJNFlCuyU0tAAFIqnhAm4VfUe3YAgKQWOmA6qr7/LCp+CAxR4UD2iwiGw5lZKlwQMlJHBxMzVLhgBiBclc4ILMN1A1BbAPlqXRAZiXm98J2jD8AEise0LEnN7UABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCApAAFICkAAkgIQgKQABCCp4gHVVVVduxvnbw4wORpVOqD67KZdzy9bAGWqcECbxcx9vVgBKE+FA1rP3eqrXV6sAJSlwgH5Eci0vARQlgoHFFdc63kF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"><!-- --></p>
<p>Comment on difference in accuracy: In this data set, both Early Stopping and L2 are extremely accurate due to the large number of the data points.</p>
</div>
<div id="trainvalidation-loss-plot-2" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run CV for whole dataset</span>
<span class="cf">if</span>(data.set<span class="op">$</span>is.<span class="dv">01</span>){
  <span class="co"># Binary</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMLogisticLossL2CV</span>(data.set<span class="op">$</span>features, data.set<span class="op">$</span>labels, <span class="ot">NULL</span>, penalty.vec)
}<span class="cf">else</span>{
  <span class="co"># Regression</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(data.set<span class="op">$</span>features,data.set<span class="op">$</span>labels,<span class="ot">NULL</span>, penalty.vec)
}

dot.x &lt;-<span class="st"> </span>model.list<span class="op">$</span>selected.penalty
dot.y &lt;-<span class="st"> </span>model.list<span class="op">$</span>mean.validation.loss.vec[penalty.vec <span class="op">==</span><span class="st"> </span>model.list<span class="op">$</span>selected.penalty]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec),
  <span class="dt">x =</span> <span class="kw">as.matrix</span>(penalty.vec),
  <span class="dt">xlab =</span> <span class="st">"penalty"</span>,
  <span class="dt">ylab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">type =</span> <span class="st">"l"</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
    <span class="dt">x =</span> <span class="dv">0</span>,
    <span class="dt">y =</span> <span class="kw">max</span>(<span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec)),
    <span class="kw">c</span>(<span class="st">"Validation loss"</span>, <span class="st">"Train loss"</span>),
    <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
    <span class="dt">xjust =</span> <span class="dv">0</span>,
    <span class="dt">yjust =</span> <span class="dv">1</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>What are the optimal regularization parameters? Answer: 4.8</p>
</div>
</div>
<div id="data-set-4-prostate" class="section level2">
<h2>Data set 4: prostate</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#prostate</span>
data.name  =<span class="st"> </span><span class="dv">4</span>
data.set &lt;-<span class="st"> </span>data.list[[data.name]]
test.loss.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)

<span class="co">#Check data type here:</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)

fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">length</span>(data.set<span class="op">$</span>labels)))

penalty.vec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="op">-</span><span class="fl">0.1</span>)

<span class="cf">for</span> (i.fold <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n.folds)) {
  train.index &lt;-<span class="st"> </span>fold.vec <span class="op">!=</span><span class="st"> </span>i.fold
  test.index &lt;-<span class="st"> </span><span class="op">!</span>train.index

  x.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>features[train.index, ]
  y.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[train.index]
  x.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>feature[test.index, ]
  y.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[test.index]

  <span class="cf">if</span> (data.set<span class="op">$</span>is.<span class="dv">01</span>) {
    <span class="co"># binary data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 100L, <span class="fl">0.5</span>)
    L2.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-
<span class="st">      </span><span class="kw">ifelse</span>(earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    L2.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(L2.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">mean</span>(y.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span> , <span class="dv">1</span>, <span class="dv">0</span>)
    <span class="co"># baseline.predict &lt;- mean(y.test)</span>

  } <span class="cf">else</span>{
    <span class="co"># regression data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMSquareLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 500L)
    L2.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-<span class="st"> </span>earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    L2.predict &lt;-<span class="st"> </span>L2.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">mean</span>(y.test)
  }

  <span class="co"># L2 loss</span>
  earlystopping.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((earlystopping.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  L2.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((L2.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  baseline.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((baseline.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

  test.loss.mat[i.fold,] =<span class="st"> </span><span class="kw">c</span>(earlystopping.loss, L2.loss, baseline.loss)
}</code></pre></div>
<div id="matrix-of-loss-values-3" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show result</span>
<span class="kw">colnames</span>(test.loss.mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Early Stopping"</span>, <span class="st">"L2"</span>, <span class="st">"Baseline"</span>)

test.loss.mat
<span class="co">#&gt;      Early Stopping        L2  Baseline</span>
<span class="co">#&gt; [1,]      0.3451739 0.3829302 0.7514432</span>
<span class="co">#&gt; [2,]      0.5096725 0.4981539 1.1907989</span>
<span class="co">#&gt; [3,]      0.7147873 0.8962265 1.4294445</span>
<span class="co">#&gt; [4,]      0.6799054 0.6639192 1.9157589</span>

<span class="co"># plot result</span>
<span class="kw">barplot</span>(
  test.loss.mat,
  <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">"Binary Classification: "</span>, <span class="st">"prostate"</span>),
  <span class="dt">xlab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(test.loss.mat)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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EEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEhYEOjx6rJ6nRVFcfp+7zeEYTAj0PTsvl663vsdYRCsCNSo4zSCjLAi0MOFE2hGJ5YZVgSiBcoUGwJV58/FeRlOpyEjLAhUOodObqsLMfzJDSMCQa4gEEgYE2jKVVhmGBNouZSWJMVBemwL1FdxkAwEAgkEAgkEAgkLAvk70Z41V2EIZBULApXzm21X7whkFRMCVQadpywODocNgcpZsXkkGQJZxYhABy4OkoFAIIFAIIFAIIFAIIFAIIFAsIViMwgEmyn+uQkEgi0gEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEGxhy38ph0CwmeKPm0Ag2AICgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgUT+As1v/Nf4T98nKQ52I3uBpsWlX5iFBak42JHcBZrftNpMz+7l4mBXchfo8eo6LM7WdGII1Ce5C0QLNDC5C1SdAzVNEOdAg5C9QFUn5q/C1rQ/CNQv+Qt06OKgAwKBxIgEmnIVNgAjEmi5lJYkxcHTjFegvoqDDggEEggEEggEErkLFG4jbhjQgUB9krtA5fxm7UCgfYqDHcleoMqg85TFwW7kL1A5K643/h2B+mQEAh24OOiAQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQCCBQOOg2EyPb4xAo2BLpnp8YwQaBQgUx5SwfumLswkCxTElrF/64myCQHFMCeuXvjibIFAcU8L6pS/OJggUx5SwfumLswkCxTElrF/64myCQHFMCeuXvjibIFAcU8L6pS/OJggUx5SwfumLswkCxTElrF/64myCQHFMCeuXvjibIFAcU8L6pS/OJggUx5SwfumLswkCxTElrF/64myCQHFMCeuXvjibIFAcU8L6pS/OJggU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"><!-- --></p>
<p>Comment on difference in accuracy: In this data set, Early Stopping and L2 are both accurate enough to predict the label comparing with the baseline predictor.</p>
</div>
<div id="trainvalidation-loss-plot-3" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run CV for whole dataset</span>
<span class="cf">if</span>(data.set<span class="op">$</span>is.<span class="dv">01</span>){
  <span class="co"># Binary</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMLogisticLossL2CV</span>(data.set<span class="op">$</span>features, data.set<span class="op">$</span>labels, <span class="ot">NULL</span>, penalty.vec)
}<span class="cf">else</span>{
  <span class="co"># Regression</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(data.set<span class="op">$</span>features,data.set<span class="op">$</span>labels,<span class="ot">NULL</span>, penalty.vec)
}

dot.x &lt;-<span class="st"> </span>model.list<span class="op">$</span>selected.penalty
dot.y &lt;-<span class="st"> </span>model.list<span class="op">$</span>mean.validation.loss.vec[penalty.vec <span class="op">==</span><span class="st"> </span>model.list<span class="op">$</span>selected.penalty]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec),
  <span class="dt">x =</span> <span class="kw">as.matrix</span>(penalty.vec),
  <span class="dt">xlab =</span> <span class="st">"penalty"</span>,
  <span class="dt">ylab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">type =</span> <span class="st">"l"</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
    <span class="dt">x =</span> <span class="dv">0</span>,
    <span class="dt">y =</span> <span class="kw">max</span>(<span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec)),
    <span class="kw">c</span>(<span class="st">"Validation loss"</span>, <span class="st">"Train loss"</span>),
    <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
    <span class="dt">xjust =</span> <span class="dv">0</span>,
    <span class="dt">yjust =</span> <span class="dv">1</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>What are the optimal regularization parameters? Answer: 0.1</p>
</div>
</div>
<div id="data-set-5-ozone" class="section level2">
<h2>Data set 5: ozone</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ozone</span>
data.name  =<span class="st"> </span><span class="dv">5</span>
data.set &lt;-<span class="st"> </span>data.list[[data.name]]
test.loss.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)

<span class="co">#Check data type here:</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)

fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">length</span>(data.set<span class="op">$</span>labels)))

penalty.vec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="op">-</span><span class="fl">0.1</span>)

<span class="cf">for</span> (i.fold <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n.folds)) {
  train.index &lt;-<span class="st"> </span>fold.vec <span class="op">!=</span><span class="st"> </span>i.fold
  test.index &lt;-<span class="st"> </span><span class="op">!</span>train.index

  x.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>features[train.index, ]
  y.train &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[train.index]
  x.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>feature[test.index, ]
  y.test &lt;-<span class="st"> </span>data.set<span class="op">$</span>labels[test.index]

  <span class="cf">if</span> (data.set<span class="op">$</span>is.<span class="dv">01</span>) {
    <span class="co"># binary data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 100L, <span class="fl">0.5</span>)
    L2.list &lt;-
<span class="st">      </span><span class="kw">LMLogisticLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-
<span class="st">      </span><span class="kw">ifelse</span>(earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    L2.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(L2.list<span class="op">$</span><span class="kw">predict</span>(x.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">mean</span>(y.test) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span> , <span class="dv">1</span>, <span class="dv">0</span>)
    <span class="co"># baseline.predict &lt;- mean(y.test)</span>

  } <span class="cf">else</span>{
    <span class="co"># regression data</span>
    earlystopping.list &lt;-
<span class="st">      </span><span class="kw">LMSquareLossEarlyStoppingCV</span>(x.train, y.train, <span class="ot">NULL</span>, 50L)
    L2.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(x.train, y.train, <span class="ot">NULL</span>, penalty.vec)

    earlystopping.predict &lt;-<span class="st"> </span>earlystopping.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    L2.predict &lt;-<span class="st"> </span>L2.list<span class="op">$</span><span class="kw">predict</span>(x.test)
    baseline.predict &lt;-<span class="st"> </span><span class="kw">mean</span>(y.test)
  }

  <span class="co"># L2 loss</span>
  earlystopping.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((earlystopping.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  L2.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((L2.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  baseline.loss &lt;-<span class="st"> </span><span class="kw">mean</span>((baseline.predict <span class="op">-</span><span class="st"> </span>y.test) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

  test.loss.mat[i.fold,] =<span class="st"> </span><span class="kw">c</span>(earlystopping.loss, L2.loss, baseline.loss)
}</code></pre></div>
<div id="matrix-of-loss-values-4" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show result</span>
<span class="kw">colnames</span>(test.loss.mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Early Stopping"</span>, <span class="st">"L2"</span>, <span class="st">"Baseline"</span>)

test.loss.mat
<span class="co">#&gt;      Early Stopping       L2  Baseline</span>
<span class="co">#&gt; [1,]       327.9076 447.2610  572.3520</span>
<span class="co">#&gt; [2,]       408.0894 413.7400  652.1671</span>
<span class="co">#&gt; [3,]       843.8591 461.3085  879.0038</span>
<span class="co">#&gt; [4,]      1519.1714 941.0776 1882.6118</span>

<span class="co"># plot result</span>
<span class="kw">barplot</span>(
  test.loss.mat,
  <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">"Binary Classification: "</span>, <span class="st">"ozone"</span>),
  <span class="dt">xlab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(test.loss.mat)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>Comment on difference in accuracy: In this data set, Early Stopping and L2 are both accurate enough to predict the label comparing with the baseline predictor.</p>
</div>
<div id="trainvalidation-loss-plot-4" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run CV for whole dataset</span>
<span class="cf">if</span>(data.set<span class="op">$</span>is.<span class="dv">01</span>){
  <span class="co"># Binary</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMLogisticLossL2CV</span>(data.set<span class="op">$</span>features, data.set<span class="op">$</span>labels, <span class="ot">NULL</span>, penalty.vec)
}<span class="cf">else</span>{
  <span class="co"># Regression</span>
  model.list &lt;-<span class="st"> </span><span class="kw">LMSquareLossL2CV</span>(data.set<span class="op">$</span>features,data.set<span class="op">$</span>labels,<span class="ot">NULL</span>, penalty.vec)
}

dot.x &lt;-<span class="st"> </span>model.list<span class="op">$</span>selected.penalty
dot.y &lt;-<span class="st"> </span>model.list<span class="op">$</span>mean.validation.loss.vec[penalty.vec <span class="op">==</span><span class="st"> </span>model.list<span class="op">$</span>selected.penalty]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec),
  <span class="dt">x =</span> <span class="kw">as.matrix</span>(penalty.vec),
  <span class="dt">xlab =</span> <span class="st">"penalty"</span>,
  <span class="dt">ylab =</span> <span class="st">"mean loss value"</span>,
  <span class="dt">type =</span> <span class="st">"l"</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
    <span class="dt">x =</span> <span class="dv">0</span>,
    <span class="dt">y =</span> <span class="kw">max</span>(<span class="kw">cbind</span>(model.list<span class="op">$</span>mean.validation.loss.vec, model.list<span class="op">$</span>mean.train.loss.vec)),
    <span class="kw">c</span>(<span class="st">"Validation loss"</span>, <span class="st">"Train loss"</span>),
    <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
    <span class="dt">xjust =</span> <span class="dv">0</span>,
    <span class="dt">yjust =</span> <span class="dv">1</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>What are the optimal regularization parameters? Answer: 0.1</p>
</div>
</div>
<div id="end-of-the-report" class="section level2">
<h2>End of the report</h2>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>